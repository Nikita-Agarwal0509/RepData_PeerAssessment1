---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---
library(dplyr)
library(ggplot2)
library(scales)

## Loading and preprocessing the data
steps <- read.csv("./data/activity.csv", header = TRUE)

# Convert date to Date
steps$date <- as.Date(steps$date)

# Convert interval to HH:MM format by padding with leading zeros
steps$interval <- 
  format(strptime(formatC(steps$interval, width = 4, format = "d", flag = "0"), format="%H%M"), format = "%H:%M")


## What is mean total number of steps taken per day?
dailySteps <- steps %>%  
          group_by(date) %>%
          summarise(total = sum(steps))
# Plot histogram of mean steps per day

ggplot(dailySteps, aes(total)) + 
  geom_histogram(binwidth = 500, fill = "deeppink4") +
  labs(x = "Total Daily Steps", 
       y = "Frequency", 
       title = "Daily Steps")
       ![Daily Steps](https://user-images.githubusercontent.com/62657395/116236871-3234be00-a77d-11eb-8361-38d5adae5097.png)
       
       ## Mean number of steps per day

mean(dailySteps$total, na.rm = TRUE)

## Median number of steps per day

median(dailySteps$total, na.rm = TRUE)
          

## What is the average daily activity pattern?
intSteps <- steps %>% 
  group_by(interval) %>%
  summarise(mean = mean(steps, na.rm = TRUE))
  ggplot(intSteps, aes(as.POSIXct(interval, format = "%H:%M"), mean)) + 
  geom_line(col = "deeppink4") +
  scale_x_datetime(labels = date_format("%H:%M"), 
                   date_breaks = "4 hours") +
  labs(x = "Five Minute Interval", 
       y = "Number of Steps", 
       title = "Average Steps by time of day")
       ![Average Steps by time of the day](https://user-images.githubusercontent.com/62657395/116237168-82ac1b80-a77d-11eb-8b89-b01d1df4bdbf.png)
       
  max(intSteps$mean)
intSteps[which.max(intSteps$mean), ]


## Imputing missing values

# Number of observations with NA values 
sum(!complete.cases(steps))
# Create a new dataset that is equal to the original dataset but with the missing data filled in.

imputeSteps <- steps %>%
    group_by(interval) %>%
    mutate(steps = ifelse(is.na(steps), mean(steps, na.rm = TRUE), steps))
# Make a histogram of the total number of steps taken each day (with missing values subbed in)

imputedDailySteps <- imputeSteps %>% 
  group_by(date) %>%
  summarise(total = sum(steps))

ggplot(imputedDailySteps, aes(total)) + 
  geom_histogram(binwidth = 500, 
                 fill = "deeppink4") +
  labs(x = "Total Daily Steps", 
       y = "Frequency", 
       title = "Daily_Steps")
       ![Daily_Steps](https://user-images.githubusercontent.com/62657395/116237427-d3bc0f80-a77d-11eb-915e-e7e9657251ee.png)
## Mean number of steps per day

mean(imputedDailySteps$total, na.rm = TRUE)
## Median number of steps per day

median(imputedDailySteps$total, na.rm = TRUE)
       

## Are there differences in activity patterns between weekdays and weekends?

wSteps <- imputeSteps %>%
  mutate(wkday = ifelse(weekdays(date) %in% c("Saturday", "Sunday"), "Weekend", "Weekday" ))

# Turn this into Factor

wSteps <- wSteps %>%
  mutate( wkday = as.factor(wkday) )
  wIntSteps <- wSteps %>% 
  group_by(interval,wkday) %>%
  summarise(mean = mean(steps, na.rm = TRUE))
  # Create time series plot with faceting on the new wkday factor

ggplot(wIntSteps, aes(as.POSIXct(interval, format = "%H:%M"), mean, col = wkday)) + 
  geom_line(show.legend = F) +
  facet_grid(rows = wIntSteps$wkday) +
  scale_x_datetime(labels = date_format("%H:%M"), 
                   date_breaks = "4 hours") +
  labs(x = "Five Minute Interval", 
       y = "Number of Steps", 
       title = "Avg steps by time of day")
       ![Avg steps by time of the day](https://user-images.githubusercontent.com/62657395/116237631-1a116e80-a77e-11eb-9fc1-db5dc32ef985.png)

